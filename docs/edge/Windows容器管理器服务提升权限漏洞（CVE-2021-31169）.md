# Windows容器管理器服务提升权限漏洞（CVE-2021-31169）

容器管理器服务在不模拟导致EoP的访问令牌的情况下创建AppContainer进程。容器管理器服务用于Windows Sandbox和Microsoft Defender Application Guard创建轻量级VM。它公开了一个ACLed的RPC服务，允许每个人都可以调用它。这与VM计算服务或Hyper-V本身形成鲜明对比，后者需要成为Hyper-V Administrators组的成员，根据服务标准，该组被视为不在范围之内。

poc：https://packetstormsecurity.com/files/162557/Windows-Container-Manager-Service-Arbitrary-Object-Directory-Creation-Privilege-Escalation.html

* 1）编译C#项目。需要获取NuGet库。包含.NET 5和.NET 4.71版本。
* 2）在系统上安装Microsoft Defender Application Guard或Windows沙盒，然后重新启动。
* 3）以任何用户帐户运行POC。